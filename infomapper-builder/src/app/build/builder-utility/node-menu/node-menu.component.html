<button mat-icon-button [matMenuTriggerFor]="nodeMenu" class="node-icon-button"
data-cy="NEEDS-TO-BE-UPDATED">
  <fa-icon class="fa-icon" [icon]=faEllipsisVertical size="xl"></fa-icon>
</button>
<mat-menu #nodeMenu="matMenu">
  <button mat-menu-item (click)="sendMenuChoice(node, 'editConfig')"
  data-cy="NEEDS-TO-BE-UPDATED">
    Edit configuration
  </button>

  <ng-container *ngIf="node.level === 'Application'">
    <div matTooltip="Save configuration before moving on"
    [matTooltipDisabled]="(validAppSaveState | async)" matTooltipPosition="right">
      <button mat-menu-item (click)="sendMenuChoice(node, 'addDatastore')"
      [disabled]="!(validAppSaveState | async)" data-cy="">
        Add Datastore
      </button>

      <button mat-menu-item (click)="sendMenuChoice(node, 'addMainMenu')"
      [disabled]="!(validAppSaveState | async)" data-cy="">
        Add Main Menu
      </button>
    </div>
    
  </ng-container>

  <ng-container *ngIf="node.level === 'Main Menu'">
    <div matTooltip="Save configuration before moving on"
    [matTooltipDisabled]="(validAppSaveState | async)" matTooltipPosition="right">
      <button mat-menu-item (click)="sendMenuChoice(node, 'addSubMenu')"
      [disabled]="!(validAppSaveState | async)" data-cy="">
        Add SubMenu
      </button>
    </div>
  </ng-container>
  
  <ng-container *ngIf="node.level !== 'Application'">
    <mat-divider></mat-divider>
    <mat-divider></mat-divider>
    <mat-divider></mat-divider>

    <button mat-menu-item (click)="sendMenuChoice(node, 'removeNode')"
    data-cy="NEEDS-TO-BE-UPDATED">
      Delete {{ node.level }}
    </button>
  </ng-container>

</mat-menu>